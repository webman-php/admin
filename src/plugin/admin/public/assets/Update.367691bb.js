var st=Object.defineProperty,at=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var Ke=Object.getOwnPropertySymbols;var rt=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable;var _e=(e,t,l)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,U=(e,t)=>{for(var l in t||(t={}))rt.call(t,l)&&_e(e,l,t[l]);if(Ke)for(var l of Ke(t))it.call(t,l)&&_e(e,l,t[l]);return e},fe=(e,t)=>at(e,ct(t));var te=(e,t,l)=>new Promise((p,x)=>{var m=f=>{try{o(l.next(f))}catch(b){x(b)}},n=f=>{try{o(l.throw(f))}catch(b){x(b)}},o=f=>f.done?p(f.value):Promise.resolve(f.value).then(m,n);o((l=l.apply(e,t)).next())});import{T as ot,B as ut}from"./BasicForm.1fff6f7d.js";import{B as dt,a as ft}from"./index.aafb2f3b.js";import{ez as ht,eA as yt,eB as pt,eC as mt,eD as gt,eE as vt,ed as kt,ej as Ce,eF as bt,eG as St,eH as xt,eI as Kt,a as re,r as E,eJ as _t,c as Ct,f as N,V as Y,o as D,h as W,k as u,aY as Lt,aN as H,aM as le,p as V,q as Le,t as Ae,cM as At,n as Ee,j as k,eK as Et,cX as se,F as ae,b5 as wt,dW as Tt,b6 as Bt,b7 as Mt,eL as Dt,cc as ce,dk as It,cW as $t,cw as Ft,eM as Ot,dK as Nt,a5 as ve,eN as we,am as Ye,ac as Xe,bT as We,cj as qe,eO as Ut,eP as Pt,bB as jt,m as Te,ab as ne,ca as Rt,af as Ht,c9 as he,eQ as Vt,es as Yt,a3 as q,eR as Xt,cH as Wt,d8 as qt,w as Be,v as Me,cJ as zt,b8 as ze,e9 as De,eS as Gt,cg as Ie,ck as Jt,aJ as Qt,aL as ye,i as X,x as Zt}from"./index.02bbedaf.js";import{a as pe,b as $e}from"./common.b6407f2a.js";import{f as en}from"./fromPairs.84aabb58.js";import{D as tn}from"./index.441385e5.js";import{g as nn}from"./_baseIteratee.2b89f8d1.js";import{t as ln}from"./util.3d1d31fd.js";import"./index.47561936.js";import"./index.9a84248c.js";import"./index.2a917be4.js";import"./index.5be6cedd.js";import"./index.29c90a5d.js";import"./index.d5cdfa6a.js";import"./index.125d35f2.js";import"./index.00a4dc86.js";import"./uniqBy.e456814b.js";import"./download.d180e438.js";import"./index.4792e25b.js";import"./useWindowSizeFn.c5b50549.js";import"./FullscreenOutlined.a5f55a02.js";var sn=200;function an(e,t,l,p){var x=-1,m=mt,n=!0,o=e.length,f=[],b=t.length;if(!o)return f;l&&(t=ht(t,yt(l))),p?(m=gt,n=!1):t.length>=sn&&(m=vt,n=!1,t=new pt(t));e:for(;++x<o;){var g=e[x],i=l==null?g:l(g);if(g=p||g!==0?g:0,n&&i===i){for(var s=b;s--;)if(t[s]===i)continue e;f.push(g)}else m(t,i,p)||f.push(g)}return f}var cn=kt(function(e,t){return Ce(e)?an(e,bt(t,1,Ce,!0)):[]}),rn=cn;function ke(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((l,p)=>l+ke(e,p),""):Object.keys(t).reduce((l,p)=>l+(t[p]?ke(e,p):""),""):""}function on(e){return(t,l)=>(t&&typeof t!="string"&&(l=t,t=""),t=t?`${e}__${t}`:e,`${t}${ke(t,l)}`)}function Ge(e){return[on(`${St}-${e}`)]}const Fe=Symbol(),Oe=Symbol();function un(e,t){if(!xt(e)||!!e[Oe])return e;const{values:l,required:p,default:x,type:m,validator:n}=e,o=l||n?f=>{let b=!1,g=[];if(l&&(g=[...l,x],b||(b=g.includes(f))),n&&(b||(b=n(f))),!b&&g.length>0){const i=[...new Set(g)].map(s=>JSON.stringify(s)).join(", ");Kt(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${i}], got value ${JSON.stringify(f)}.`)}return b}:void 0;return{type:typeof m=="object"&&Object.getOwnPropertySymbols(m).includes(Fe)?m[Fe]:m,required:!!p,default:x,validator:o,[Oe]:!0}}const dn=e=>en(Object.entries(e).map(([t,l])=>[t,un(l,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const fn=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],hn=dn({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),yn={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},pn=re({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const l=e,p=E(""),[x]=Ge("tree-header"),m=_t(),{t:n}=Ct(),o=N(()=>{const s=m.headerTitle||l.title;return["mr-1","w-full",{["ml-5"]:s}]}),f=N(()=>{const{checkable:s}=l,a=[{label:n("component.tree.expandAll"),value:T.EXPAND_ALL},{label:n("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:s}];return s?[{label:n("component.tree.selectAll"),value:T.SELECT_ALL},{label:n("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:s},...a,{label:n("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:n("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:a});function b(s){var r,d,y,h;const{key:a}=s;switch(a){case T.SELECT_ALL:(r=l.checkAll)==null||r.call(l,!0);break;case T.UN_SELECT_ALL:(d=l.checkAll)==null||d.call(l,!1);break;case T.EXPAND_ALL:(y=l.expandAll)==null||y.call(l,!0);break;case T.UN_EXPAND_ALL:(h=l.expandAll)==null||h.call(l,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function g(s){t("search",s)}const i=Ft(g,200);return Y(()=>p.value,s=>{i(s)}),Y(()=>l.searchText,s=>{s!==p.value&&(p.value=s)}),(s,a)=>(D(),W("div",{class:Ee([u(x)(),"flex px-2 py-1.5 items-center"])},[u(m).headerTitle?Lt(s.$slots,"headerTitle",{key:0}):H("",!0),!u(m).headerTitle&&s.title?(D(),le(u(At),{key:1,helpMessage:s.helpMessage},{default:V(()=>[Le(Ae(s.title),1)]),_:1},8,["helpMessage"])):H("",!0),s.search||s.toolbar?(D(),W("div",yn,[s.search?(D(),W("div",{key:0,class:Ee(u(o))},[k(u(Et),{placeholder:u(n)("common.searchText"),size:"small",allowClear:"",value:p.value,"onUpdate:value":a[0]||(a[0]=r=>p.value=r)},null,8,["placeholder","value"])],2)):H("",!0),s.toolbar?(D(),le(u($t),{key:1,onClick:a[1]||(a[1]=It(()=>{},["prevent"]))},{overlay:V(()=>[k(u(se),{onClick:b},{default:V(()=>[(D(!0),W(ae,null,wt(u(f),r=>(D(),W(ae,{key:r.value},[k(u(Tt),Bt(Mt({key:r.value})),{default:V(()=>[Le(Ae(r.label),1)]),_:2},1040),r.divider?(D(),le(u(Dt),{key:0})):H("",!0)],64))),128))]),_:1})]),default:V(()=>[k(u(ce),{icon:"ion:ellipsis-vertical"})]),_:1})):H("",!0)])):H("",!0)],2))}}),mn=({icon:e})=>e?Ot(e)?Nt(ce,{icon:e,class:"mr-1"}):ce:null;function gn(e,t){function l(i){const s=[],a=i||u(e),{key:r,children:d}=u(t);if(!d||!r)return s;for(let y=0;y<a.length;y++){const h=a[y];s.push(h[r]);const S=h[d];S&&S.length&&s.push(...l(S))}return s}function p(i){const s=[],a=i||u(e),{key:r,children:d}=u(t);if(!d||!r)return s;for(let y=0;y<a.length;y++){const h=a[y];h.disabled!==!0&&h.selectable!==!1&&s.push(h[r]);const S=h[d];S&&S.length&&s.push(...p(S))}return s}function x(i,s){const a=[],r=s||u(e),{key:d,children:y}=u(t);if(!y||!d)return a;for(let h=0;h<r.length;h++){const S=r[h],A=S[y];i===S[d]?(a.push(S[d]),A&&A.length&&a.push(...l(A))):A&&A.length&&a.push(...x(i,A))}return a}function m(i,s,a){if(!i)return;const r=a||u(e),{key:d,children:y}=u(t);if(!(!y||!d))for(let h=0;h<r.length;h++){const S=r[h],A=S[y];if(S[d]===i){r[h]=U(U({},r[h]),s);break}else A&&A.length&&m(i,s,S[y])}}function n(i=1,s,a=1){if(!i)return[];const r=[],d=s||u(e)||[];for(let y=0;y<d.length;y++){const h=d[y],{key:S,children:A}=u(t),j=S?h[S]:"",I=A?h[A]:[];r.push(j),I&&I.length&&a<i&&(a+=1,r.push(...n(i,I,a)))}return r}function o({parentKey:i=null,node:s,push:a="push"}){const r=ve(u(e));if(!i){r[a](s),e.value=r;return}const{key:d,children:y}=u(t);!y||!d||(we(r,h=>{if(h[d]===i)return h[y]=h[y]||[],h[y][a](s),!0}),e.value=r)}function f({parentKey:i=null,list:s,push:a="push"}){const r=ve(u(e));if(!(!s||s.length<1))if(i){const{key:d,children:y}=u(t);if(!y||!d)return;we(r,h=>{if(h[d]===i){h[y]=h[y]||[];for(let S=0;S<s.length;S++)h[y][a](s[S]);return e.value=r,!0}})}else for(let d=0;d<s.length;d++)r[a](s[d])}function b(i,s){if(!i)return;const a=s||u(e),{key:r,children:d}=u(t);if(!(!d||!r))for(let y=0;y<a.length;y++){const h=a[y],S=h[d];if(h[r]===i){a.splice(y,1);break}else S&&S.length&&b(i,h[d])}}function g(i,s,a){return!i&&i!==0?null:((s||u(e)).forEach(d=>{if((a==null?void 0:a.key)||(a==null?void 0:a.key)===0)return a;if(d.key===i){a=d;return}d.children&&d.children.length&&(a=g(i,d.children,a))}),a||null)}return{deleteNodeByKey:b,insertNodeByKey:o,insertNodesByKey:f,filterByLevel:n,updateNodeByKey:m,getAllKeys:l,getChildrenKeys:x,getEnabledKeys:p,getSelectedNode:g}}function vn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!qe(e)}const me="context-menu",kn={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},Ne=e=>{const{item:t}=e;return k("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&k(ce,{class:"mr-2",icon:t.icon},null),k("span",null,[t.label])])};var bn=re({name:"ContextMenu",props:kn,setup(e){const t=E(null),l=E(!1),p=N(()=>{const{axis:n,items:o,styles:f,width:b}=e,{x:g,y:i}=n||{x:0,y:0},s=(o||[]).length*40,a=b,r=document.body,d=r.clientWidth<g+a?g-a:g,y=r.clientHeight<i+s?i-s:i;return fe(U({},f),{position:"absolute",width:`${b}px`,left:`${d+1}px`,top:`${y+1}px`,zIndex:9999})});Ye(()=>{Xe(()=>l.value=!0)}),We(()=>{const n=u(t);n&&document.body.removeChild(n)});function x(n,o){const{handler:f,disabled:b}=n;b||(l.value=!1,o==null||o.stopPropagation(),o==null||o.preventDefault(),f==null||f())}function m(n){return n.filter(f=>!f.hidden).map(f=>{const{disabled:b,label:g,children:i,divider:s=!1}=f,a={item:f,handler:x,showIcon:e.showIcon};return!i||i.length===0?k(ae,null,[k(se.Item,{disabled:b,class:`${me}__item`,key:g},{default:()=>[k(Ne,a,null)]}),s?k(tn,{key:`d-${g}`},null):null]):u(l)?k(se.SubMenu,{key:g,disabled:b,popupClassName:`${me}__popup`},{title:()=>k(Ne,a,null),default:()=>m(i)}):null})}return()=>{let n;if(!u(l))return null;const{items:o}=e;return k("div",{class:me},[k(se,{inlineIndent:12,mode:"vertical",ref:t,style:u(p)},vn(n=m(o))?n:{default:()=>[n]})])}}});const P={domList:[],resolve:()=>{}},Sn=function(e){const{event:t}=e||{};if(t&&(t==null||t.preventDefault()),!!Ut)return new Promise(l=>{const p=document.body,x=document.createElement("div"),m={};e.styles&&(m.styles=e.styles),e.items&&(m.items=e.items),e.event&&(m.customEvent=t,m.axis={x:t.clientX,y:t.clientY});const n=k(bn,m);Pt(n,x);const o=function(){P.resolve("")};P.domList.push(x);const f=function(){P.domList.forEach(b=>{try{b&&p.removeChild(b)}catch(g){}}),p.removeEventListener("click",o),p.removeEventListener("scroll",o)};P.resolve=function(b){f(),l(b)},f(),p.appendChild(x),p.addEventListener("click",o),p.addEventListener("scroll",o)})},Ue=function(){P&&(P.resolve(""),P.domList=[])};function xn(e=!0){return jt()&&e&&We(()=>{Ue()}),[Sn,Ue]}function Kn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!qe(e)}var _n=re({name:"BasicTree",inheritAttrs:!1,props:hn,emits:fn,setup(e,{attrs:t,slots:l,emit:p,expose:x}){const[m]=Ge("tree"),n=Te({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),o=Te({startSearch:!1,searchText:"",searchData:[]}),f=E([]),[b]=xn(),g=N(()=>{const{fieldNames:c}=e;return U({children:"children",title:"title",key:"key"},c)}),i=N(()=>{let c=fe(U(U({blockNode:!0},t),e),{expandedKeys:n.expandedKeys,selectedKeys:n.selectedKeys,checkedKeys:n.checkedKeys,checkStrictly:n.checkStrictly,fieldNames:u(g),"onUpdate:expandedKeys":v=>{n.expandedKeys=v,p("update:expandedKeys",v)},"onUpdate:selectedKeys":v=>{n.selectedKeys=v,p("update:selectedKeys",v)},onCheck:(v,_)=>{let K=ne(n.checkedKeys);if(Rt(K)&&o.startSearch){const{key:L}=u(g);K=rn(K,j(_.node.$attrs.node[L])),_.checked&&K.push(_.node.$attrs.node[L]),n.checkedKeys=K}else n.checkedKeys=v;const C=ne(n.checkedKeys);p("update:value",C),p("check",C,_)},onRightClick:ie});return Ht(c,"treeData","class")}),s=N(()=>o.startSearch?o.searchData:u(f)),a=N(()=>!s.value||s.value.length===0),{deleteNodeByKey:r,insertNodeByKey:d,insertNodesByKey:y,filterByLevel:h,updateNodeByKey:S,getAllKeys:A,getChildrenKeys:j,getEnabledKeys:I,getSelectedNode:G}=gn(f,g);function w(c,v){return!v&&e.renderIcon&&he(e.renderIcon)?e.renderIcon(c):v}function ie(_){return te(this,arguments,function*({event:c,node:v}){var $;const{rightMenuList:K=[],beforeRightClick:C}=e;let L={event:c,items:[]};if(C&&he(C)){let B=yield C(v,c);Array.isArray(B)?L.items=B:Object.assign(L,B)}else L.items=K;!(($=L.items)!=null&&$.length)||(L.items=L.items.filter(B=>!B.hidden),b(L))})}function R(c){n.expandedKeys=c}function oe(){return n.expandedKeys}function J(c){n.selectedKeys=c}function Q(){return n.selectedKeys}function be(c){n.checkedKeys=c}function Je(){return n.checkedKeys}function Se(c){n.checkedKeys=c?I():[]}function ue(c){n.expandedKeys=c?A():[]}function Qe(c){n.checkStrictly=c}Y(()=>e.searchValue,c=>{c!==o.searchText&&(o.searchText=c)},{immediate:!0}),Y(()=>e.treeData,c=>{c&&de(o.searchText)});function de(c){if(c!==o.searchText&&(o.searchText=c),p("update:searchValue",c),!c){o.startSearch=!1;return}const{filterFn:v,checkable:_,expandOnSearch:K,checkOnSearch:C,selectedOnSearch:L}=u(e);o.startSearch=!0;const{title:$,key:B}=u(g),F=[];if(o.searchData=Vt(u(f),M=>{var Z,ee;const O=v?v(c,M,u(g)):(ee=(Z=M[$])==null?void 0:Z.includes(c))!=null?ee:!1;return O&&F.push(M[B]),O},u(g)),K){const M=Yt(o.searchData).map(O=>O[B]);M&&M.length&&R(M)}C&&_&&F.length&&be(F),L&&F.length&&J(F)}function Ze(c,v){if(!(!e.clickRowToExpand||!v||v.length===0))if(!n.expandedKeys.includes(c))R([...n.expandedKeys,c]);else{const _=[...n.expandedKeys],K=_.findIndex(C=>C===c);K!==-1&&_.splice(K,1),R(_)}}q(()=>{f.value=e.treeData}),Ye(()=>{const c=parseInt(e.defaultExpandLevel);c>0?n.expandedKeys=h(c):e.defaultExpandAll&&ue(!0)}),q(()=>{n.expandedKeys=e.expandedKeys}),q(()=>{n.selectedKeys=e.selectedKeys}),q(()=>{n.checkedKeys=e.checkedKeys}),Y(()=>e.value,()=>{n.checkedKeys=ne(e.value||[])},{immediate:!0}),Y(()=>n.checkedKeys,()=>{const c=ne(n.checkedKeys);p("update:value",c),p("change",c)}),q(()=>{n.checkStrictly=e.checkStrictly});const et={setExpandedKeys:R,getExpandedKeys:oe,setSelectedKeys:J,getSelectedKeys:Q,setCheckedKeys:be,getCheckedKeys:Je,insertNodeByKey:d,insertNodesByKey:y,deleteNodeByKey:r,updateNodeByKey:S,getSelectedNode:G,checkAll:Se,expandAll:ue,filterByLevel:c=>{n.expandedKeys=h(c)},setSearchValue:c=>{de(c)},getSearchValue:()=>o.searchText};function tt(c){const{actionList:v}=e;if(!(!v||v.length===0))return v.map((_,K)=>{var L;let C=!0;return he(_.show)?C=(L=_.show)==null?void 0:L.call(_,c):Ie(_.show)&&(C=_.show),C?k("span",{key:K,class:m("action")},[_.render(c)]):null})}const nt=N(()=>{const c=ve(s.value);return Xt(c,(v,_)=>{var xe;const K=o.searchText,{highlight:C}=u(e),{title:L,key:$,children:B}=u(g),F=w(v,v.icon),M=nn(v,L),O=K?M.indexOf(K):-1,Z=o.startSearch&&!Gt(K)&&C&&O!==-1,ee=`color: ${Ie(C)?"#f50":C}`,lt=Z?k("span",{class:(xe=u(i))!=null&&xe.blockNode?`${m("content")}`:""},[k("span",null,[M.substr(0,O)]),k("span",{style:ee},[K]),k("span",null,[M.substr(O+K.length)])]):M;return v[L]=k("span",{class:`${m("title")} pl-2`,onClick:Ze.bind(null,v[$],v[B])},[l!=null&&l.title?Jt(l,"title",v):k(ae,null,[F&&k(mn,{icon:F},null),lt,k("span",{class:m("actions")},[tt(v)])])]),v}),c});return x(et),()=>{let c;const{title:v,helpMessage:_,toolbar:K,search:C,checkable:L}=e,$=v||K||C||l.headerTitle,B={height:"calc(100% - 38px)"};return k("div",{class:[m(),"h-full",t.class]},[$&&k(pn,{checkable:L,checkAll:Se,expandAll:ue,title:v,search:C,toolbar:K,helpMessage:_,onStrictlyChange:Qe,onSearch:de,searchText:o.searchText},Kn(c=Wt(l))?c:{default:()=>[c]}),k(qt,{spinning:u(e.loading),tip:"Loading..."},{default:()=>[Be(k(zt,{style:B},{default:()=>[k(ot,ze(u(i),{showIcon:!1,treeData:nt.value}),null)]}),[[Me,!u(a)]]),Be(k(De,{image:De.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[Me,u(a)]])]})])}}});const ge=E(null),z=E(null),Cn="/app/admin/auth/adminrule/tree",Pe=E(""),je=E(""),Re=E(""),He=E(""),Ve=E([]),Ln=re({components:{BasicForm:ut,BasicModal:dt,BasicTree:_n},emits:["reload","register"],setup(e,{emit:t}){const l=E("Add record"),p=E(""),x=E(""),m=E(""),n=E("insert"),o=[],[f,{closeModal:b}]=ft(a=>te(this,null,function*(){var G;x.value=a.column,m.value=a.value,p.value=a.table,Pe.value=a.selectUrl,je.value=a.insertUrl,Re.value=a.updateUrl,He.value=a.schemaUrl,x.value?(n.value="edit",l.value="Edit record"):(n.value="insert",l.value="insert record");const r=yield pe(He.value),d=r.forms,y=r.columns,h={};for(let w of y)h[w.field]=w;const S=ge.value;if(!S)return;yield S.resetSchema([]);const A={};A[x.value]=m.value;const j=n.value=="edit"?yield pe(Pe.value,A):{},I=n.value=="edit"&&j.items.length?j.items[0]:{};for(let w of d){if(!w.form_show)continue;if(w.field=="rules"){let J=yield pe(Cn);Ve.value=J||[];let Q=((G=I.rules)==null?void 0:G.split(","))||[];Xe(()=>{!z.value||(z.value.setCheckedKeys(Q),z.value.setExpandedKeys(Q))});continue}let[ie,R,oe]=ln(w,I[w.field],n.value);S.appendSchemaByField({field:w.field,component:ie,label:w.comment||w.field,colProps:{span:24},required:n.value=="edit"&&w.field=="password"?!1:!h[w.field].nullable,componentProps:R,defaultValue:oe},"")}})),{createMessage:g}=Zt(),{success:i}=g;return{formElRef:ge,treeRef:z,handleSubmit:()=>te(this,null,function*(){var a;try{const r=ge.value;if(!r)return;const d=yield r.validate();d.rules=((a=z.value)==null?void 0:a.getCheckedKeys())||[],n.value=="edit"?yield $e(Re.value,{column:x.value,value:m.value,data:d}):yield $e(je.value,{data:d}),b(),i("Successful operation"),t("reload")}catch(r){console.log(r)}}),schemas:o,register:f,title:l,treeData:Ve}}}),An={class:"mt-3"},En={class:"ant-col ant-col-24"},wn={class:"ant-row ant-form-item",style:{"row-gap":"0px"}},Tn=X("div",{class:"ant-col ant-form-item-label",style:{width:"75px"}},[X("label",{class:"ant-form-item-required ant-form-item-no-colon"},"Permissions")],-1),Bn={class:"ant-col ant-form-item-control",style:{width:"calc(100% - 75px)"}};function Mn(e,t,l,p,x,m){const n=ye("BasicForm"),o=ye("BasicTree"),f=ye("BasicModal");return D(),le(f,ze(e.$attrs,{destroyOnClose:"",onRegister:e.register,title:e.title,onOk:e.handleSubmit}),{default:V(()=>[X("div",An,[k(n,{schemas:e.schemas,ref:"formElRef",labelWidth:75,showActionButtonGroup:!1},null,8,["schemas"]),X("div",En,[X("div",wn,[Tn,X("div",Bn,[k(o,{treeData:e.treeData,ref:"treeRef",checkable:!0,selectable:!1},null,8,["treeData"])])])])])]),_:1},16,["onRegister","title","onOk"])}var tl=Qt(Ln,[["render",Mn]]);export{tl as default};
