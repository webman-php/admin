var $e=Object.defineProperty,Pe=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var ce=(e,t,a)=>t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,O=(e,t)=>{for(var a in t||(t={}))me.call(t,a)&&ce(e,a,t[a]);if(se)for(var a of se(t))je.call(t,a)&&ce(e,a,t[a]);return e},ie=(e,t)=>Pe(e,Ue(t));var oe=(e,t,a)=>new Promise((y,_)=>{var S=k=>{try{p(a.next(k))}catch(C){_(C)}},r=k=>{try{p(a.throw(k))}catch(C){_(C)}},p=k=>k.done?y(k.value):Promise.resolve(k.value).then(S,r);p((a=a.apply(e,t)).next())});import{eK as Ve,eL as Re,eM as He,eN as Ye,eO as Xe,eP as ze,eb as qe,eh as de,eQ as We,eR as Ge,eS as Je,eT as Ze,a as ve,r as Le,eU as Qe,c as et,f as I,a1 as P,o as M,h as m,k as c,b9 as tt,aS as $,aR as G,p as j,q as ue,t as he,dI as nt,n as fe,j as A,eV as at,F as Z,aW as lt,cb as rt,aV as st,bi as ct,eW as it,aT as ot,aO as Q,bb as dt,cE as ut,bk as ht,eX as ft,bM as yt,ab as ee,eY as ye,m as pe,ag as X,dm as pt,ai as gt,b3 as J,eZ as kt,ep as bt,E as V,H as St,e_ as Kt,dF as xt,cz as vt,aI as Lt,w as ge,v as ke,bw as At,aU as Ct,e8 as be,e$ as _t,bg as Se,cA as Et}from"./index.0d073eaa.js";import{f as Tt}from"./fromPairs.84aabb58.js";import{b as wt}from"./index.e8b360cf.js";import{u as Bt}from"./useContextMenu.cd4142a5.js";import{g as Ft}from"./get.49a42f2e.js";var Dt=200;function Nt(e,t,a,y){var _=-1,S=Ye,r=!0,p=e.length,k=[],C=t.length;if(!p)return k;a&&(t=Ve(t,Re(a))),y?(S=Xe,r=!1):t.length>=Dt&&(S=ze,r=!1,t=new He(t));e:for(;++_<p;){var b=e[_],o=a==null?b:a(b);if(b=y||b!==0?b:0,r&&o===o){for(var n=C;n--;)if(t[n]===o)continue e;k.push(b)}else S(t,o,y)||k.push(b)}return k}var Mt=qe(function(e,t){return de(e)?Nt(e,We(t,1,de,!0)):[]}),It=Mt;function te(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((a,y)=>a+te(e,y),""):Object.keys(t).reduce((a,y)=>a+(t[y]?te(e,y):""),""):""}function Ot(e){return(t,a)=>(t&&typeof t!="string"&&(a=t,t=""),t=t?`${e}__${t}`:e,`${t}${te(t,a)}`)}function Ae(e){return[Ot(`${Ge}-${e}`)]}const Ke=Symbol(),xe=Symbol();function $t(e,t){if(!Je(e)||!!e[xe])return e;const{values:a,required:y,default:_,type:S,validator:r}=e,p=a||r?k=>{let C=!1,b=[];if(a&&(b=[...a,_],C||(C=b.includes(k))),r&&(C||(C=r(k))),!C&&b.length>0){const o=[...new Set(b)].map(n=>JSON.stringify(n)).join(", ");Ze(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${o}], got value ${JSON.stringify(k)}.`)}return C}:void 0;return{type:typeof S=="object"&&Object.getOwnPropertySymbols(S).includes(Ke)?S[Ke]:S,required:!!y,default:_,validator:p,[xe]:!0}}const Pt=e=>Tt(Object.entries(e).map(([t,a])=>[t,$t(a,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const Ut=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],mt=Pt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),jt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Vt=ve({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const a=e,y=Le(""),[_]=Ae("tree-header"),S=Qe(),{t:r}=et(),p=I(()=>{const n=S.headerTitle||a.title;return["mr-1","w-full",{["ml-5"]:n}]}),k=I(()=>{const{checkable:n}=a,s=[{label:r("component.tree.expandAll"),value:T.EXPAND_ALL},{label:r("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:n}];return n?[{label:r("component.tree.selectAll"),value:T.SELECT_ALL},{label:r("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:n},...s,{label:r("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:r("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:s});function C(n){var i,d,h,u;const{key:s}=n;switch(s){case T.SELECT_ALL:(i=a.checkAll)==null||i.call(a,!0);break;case T.UN_SELECT_ALL:(d=a.checkAll)==null||d.call(a,!1);break;case T.EXPAND_ALL:(h=a.expandAll)==null||h.call(a,!0);break;case T.UN_EXPAND_ALL:(u=a.expandAll)==null||u.call(a,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function b(n){t("search",n)}const o=ht(b,200);return P(()=>y.value,n=>{o(n)}),P(()=>a.searchText,n=>{n!==y.value&&(y.value=n)}),(n,s)=>(M(),m("div",{class:fe([c(_)(),"flex px-2 py-1.5 items-center"])},[c(S).headerTitle?tt(n.$slots,"headerTitle",{key:0}):$("",!0),!c(S).headerTitle&&n.title?(M(),G(c(nt),{key:1,helpMessage:n.helpMessage},{default:j(()=>[ue(he(n.title),1)]),_:1},8,["helpMessage"])):$("",!0),n.search||n.toolbar?(M(),m("div",jt,[n.search?(M(),m("div",{key:0,class:fe(c(p))},[A(c(at),{placeholder:c(r)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":s[0]||(s[0]=i=>y.value=i)},null,8,["placeholder","value"])],2)):$("",!0),n.toolbar?(M(),G(c(ut),{key:1,onClick:s[1]||(s[1]=dt(()=>{},["prevent"]))},{overlay:j(()=>[A(c(ot),{onClick:C},{default:j(()=>[(M(!0),m(Z,null,lt(c(k),i=>(M(),m(Z,{key:i.value},[A(c(rt),st(ct({key:i.value})),{default:j(()=>[ue(he(i.label),1)]),_:2},1040),i.divider?(M(),G(c(it),{key:0})):$("",!0)],64))),128))]),_:1})]),default:j(()=>[A(c(Q),{icon:"ion:ellipsis-vertical"})]),_:1})):$("",!0)])):$("",!0)],2))}}),Rt=({icon:e})=>e?ft(e)?yt(Q,{icon:e,class:"mr-1"}):Q:null;function Ht(e,t){function a(o){const n=[],s=o||c(e),{key:i,children:d}=c(t);if(!d||!i)return n;for(let h=0;h<s.length;h++){const u=s[h];n.push(u[i]);const g=u[d];g&&g.length&&n.push(...a(g))}return n}function y(o){const n=[],s=o||c(e),{key:i,children:d}=c(t);if(!d||!i)return n;for(let h=0;h<s.length;h++){const u=s[h];u.disabled!==!0&&u.selectable!==!1&&n.push(u[i]);const g=u[d];g&&g.length&&n.push(...y(g))}return n}function _(o,n){const s=[],i=n||c(e),{key:d,children:h}=c(t);if(!h||!d)return s;for(let u=0;u<i.length;u++){const g=i[u],E=g[h];o===g[d]?(s.push(g[d]),E&&E.length&&s.push(...a(E))):E&&E.length&&s.push(..._(o,E))}return s}function S(o,n,s){if(!o)return;const i=s||c(e),{key:d,children:h}=c(t);if(!(!h||!d))for(let u=0;u<i.length;u++){const g=i[u],E=g[h];if(g[d]===o){i[u]=O(O({},i[u]),n);break}else E&&E.length&&S(o,n,g[h])}}function r(o=1,n,s=1){if(!o)return[];const i=[],d=n||c(e)||[];for(let h=0;h<d.length;h++){const u=d[h],{key:g,children:E}=c(t),z=g?u[g]:"",U=E?u[E]:[];i.push(z),U&&U.length&&s<o&&(s+=1,i.push(...r(o,U,s)))}return i}function p({parentKey:o=null,node:n,push:s="push"}){const i=ee(c(e));if(!o){i[s](n),e.value=i;return}const{key:d,children:h}=c(t);!h||!d||(ye(i,u=>{if(u[d]===o)return u[h]=u[h]||[],u[h][s](n),!0}),e.value=i)}function k({parentKey:o=null,list:n,push:s="push"}){const i=ee(c(e));if(!(!n||n.length<1))if(o){const{key:d,children:h}=c(t);if(!h||!d)return;ye(i,u=>{if(u[d]===o){u[h]=u[h]||[];for(let g=0;g<n.length;g++)u[h][s](n[g]);return e.value=i,!0}})}else for(let d=0;d<n.length;d++)i[s](n[d])}function C(o,n){if(!o)return;const s=n||c(e),{key:i,children:d}=c(t);if(!(!d||!i))for(let h=0;h<s.length;h++){const u=s[h],g=u[d];if(u[i]===o){s.splice(h,1);break}else g&&g.length&&C(o,u[d])}}function b(o,n,s){return!o&&o!==0?null:((n||c(e)).forEach(d=>{if((s==null?void 0:s.key)||(s==null?void 0:s.key)===0)return s;if(d.key===o){s=d;return}d.children&&d.children.length&&(s=b(o,d.children,s))}),s||null)}return{deleteNodeByKey:C,insertNodeByKey:p,insertNodesByKey:k,filterByLevel:r,updateNodeByKey:S,getAllKeys:a,getChildrenKeys:_,getEnabledKeys:y,getSelectedNode:b}}function Yt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vt(e)}var Zt=ve({name:"BasicTree",inheritAttrs:!1,props:mt,emits:Ut,setup(e,{attrs:t,slots:a,emit:y,expose:_}){const[S]=Ae("tree"),r=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=pe({startSearch:!1,searchText:"",searchData:[]}),k=Le([]),[C]=Bt(),b=I(()=>{const{fieldNames:l}=e;return O({children:"children",title:"title",key:"key"},l)}),o=I(()=>{let l=ie(O(O({blockNode:!0},t),e),{expandedKeys:r.expandedKeys,selectedKeys:r.selectedKeys,checkedKeys:r.checkedKeys,checkStrictly:r.checkStrictly,fieldNames:c(b),"onUpdate:expandedKeys":f=>{r.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{r.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,x)=>{let K=X(r.checkedKeys);if(pt(K)&&p.startSearch){const{key:L}=c(b);K=It(K,z(x.node.$attrs.node[L])),x.checked&&K.push(x.node.$attrs.node[L]),r.checkedKeys=K}else r.checkedKeys=f;const v=X(r.checkedKeys);y("update:value",v),y("check",v,x)},onRightClick:Ee});return gt(l,"treeData","class")}),n=I(()=>p.startSearch?p.searchData:c(k)),s=I(()=>!n.value||n.value.length===0),{deleteNodeByKey:i,insertNodeByKey:d,insertNodesByKey:h,filterByLevel:u,updateNodeByKey:g,getAllKeys:E,getChildrenKeys:z,getEnabledKeys:U,getSelectedNode:Ce}=Ht(k,b);function _e(l,f){return!f&&e.renderIcon&&J(e.renderIcon)?e.renderIcon(l):f}function Ee(x){return oe(this,arguments,function*({event:l,node:f}){var F;const{rightMenuList:K=[],beforeRightClick:v}=e;let L={event:l,items:[]};if(v&&J(v)){let w=yield v(f,l);Array.isArray(w)?L.items=w:Object.assign(L,w)}else L.items=K;!((F=L.items)!=null&&F.length)||(L.items=L.items.filter(w=>!w.hidden),C(L))})}function R(l){r.expandedKeys=l}function Te(){return r.expandedKeys}function ne(l){r.selectedKeys=l}function we(){return r.selectedKeys}function ae(l){r.checkedKeys=l}function Be(){return r.checkedKeys}function le(l){r.checkedKeys=l?U():[]}function q(l){r.expandedKeys=l?E():[]}function Fe(l){r.checkStrictly=l}P(()=>e.searchValue,l=>{l!==p.searchText&&(p.searchText=l)},{immediate:!0}),P(()=>e.treeData,l=>{l&&W(p.searchText)});function W(l){if(l!==p.searchText&&(p.searchText=l),y("update:searchValue",l),!l){p.startSearch=!1;return}const{filterFn:f,checkable:x,expandOnSearch:K,checkOnSearch:v,selectedOnSearch:L}=c(e);p.startSearch=!0;const{title:F,key:w}=c(b),D=[];if(p.searchData=kt(c(k),B=>{var H,Y;const N=f?f(l,B,c(b)):(Y=(H=B[F])==null?void 0:H.includes(l))!=null?Y:!1;return N&&D.push(B[w]),N},c(b)),K){const B=bt(p.searchData).map(N=>N[w]);B&&B.length&&R(B)}v&&x&&D.length&&ae(D),L&&D.length&&ne(D)}function De(l,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!r.expandedKeys.includes(l))R([...r.expandedKeys,l]);else{const x=[...r.expandedKeys],K=x.findIndex(v=>v===l);K!==-1&&x.splice(K,1),R(x)}}V(()=>{k.value=e.treeData}),St(()=>{const l=parseInt(e.defaultExpandLevel);l>0?r.expandedKeys=u(l):e.defaultExpandAll&&q(!0)}),V(()=>{r.expandedKeys=e.expandedKeys}),V(()=>{r.selectedKeys=e.selectedKeys}),V(()=>{r.checkedKeys=e.checkedKeys}),P(()=>e.value,()=>{r.checkedKeys=X(e.value||[])},{immediate:!0}),P(()=>r.checkedKeys,()=>{const l=X(r.checkedKeys);y("update:value",l),y("change",l)}),V(()=>{r.checkStrictly=e.checkStrictly});const Ne={setExpandedKeys:R,getExpandedKeys:Te,setSelectedKeys:ne,getSelectedKeys:we,setCheckedKeys:ae,getCheckedKeys:Be,insertNodeByKey:d,insertNodesByKey:h,deleteNodeByKey:i,updateNodeByKey:g,getSelectedNode:Ce,checkAll:le,expandAll:q,filterByLevel:l=>{r.expandedKeys=u(l)},setSearchValue:l=>{W(l)},getSearchValue:()=>p.searchText};function Me(l){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((x,K)=>{var L;let v=!0;return J(x.show)?v=(L=x.show)==null?void 0:L.call(x,l):Se(x.show)&&(v=x.show),v?A("span",{key:K,class:S("action")},[x.render(l)]):null})}const Ie=I(()=>{const l=ee(n.value);return Kt(l,(f,x)=>{var re;const K=p.searchText,{highlight:v}=c(e),{title:L,key:F,children:w}=c(b),D=_e(f,f.icon),B=Ft(f,L),N=K?B.indexOf(K):-1,H=p.startSearch&&!_t(K)&&v&&N!==-1,Y=`color: ${Se(v)?"#f50":v}`,Oe=H?A("span",{class:(re=c(o))!=null&&re.blockNode?`${S("content")}`:""},[A("span",null,[B.substr(0,N)]),A("span",{style:Y},[K]),A("span",null,[B.substr(N+K.length)])]):B;return f[L]=A("span",{class:`${S("title")} pl-2`,onClick:De.bind(null,f[F],f[w])},[a!=null&&a.title?Et(a,"title",f):A(Z,null,[D&&A(Rt,{icon:D},null),Oe,A("span",{class:S("actions")},[Me(f)])])]),f}),l});return _(Ne),()=>{let l;const{title:f,helpMessage:x,toolbar:K,search:v,checkable:L}=e,F=f||K||v||a.headerTitle,w={height:"calc(100% - 38px)"};return A("div",{class:[S(),"h-full",t.class]},[F&&A(Vt,{checkable:L,checkAll:le,expandAll:q,title:f,search:v,toolbar:K,helpMessage:x,onStrictlyChange:Fe,onSearch:W,searchText:p.searchText},Yt(l=xt(a))?l:{default:()=>[l]}),A(Lt,{spinning:c(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[ge(A(At,{style:w},{default:()=>[A(wt,Ct(c(o),{showIcon:!1,treeData:Ie.value}),null)]}),[[ke,!c(s)]]),ge(A(be,{image:be.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ke,c(s)]])]})])}}});export{Zt as _};
